<link rel="stylesheet" type="text/css"
	href="__PUBLIC__/scripts/artdialog/ui-dialog.css" />
<link rel="stylesheet" type="text/css"
	href="__PUBLIC__/Adm/skin/icon/iconfont.css" />
<link rel="stylesheet" type="text/css"
	href="__PUBLIC__/Adm/skin/default/style.css" />
<script type="text/javascript" charset="utf-8"
	src="__PUBLIC__/scripts/jquery/jquery-1.11.2.min.js"></script>
<script type="text/javascript" charset="utf-8"
	src="__PUBLIC__/scripts/jquery/jquery.nicescroll.js"></script>
<script type="text/javascript" charset="utf-8"
	src="__PUBLIC__/scripts/artdialog/dialog-plus-min.js"></script>
<script type="text/javascript" charset="utf-8"
	src="__PUBLIC__/Adm/js/layindex.js"></script>
<script type="text/javascript" charset="utf-8"
	src="__PUBLIC__/Adm/js/laymain.js"></script>
<script type="text/javascript" charset="utf-8"
	src="__PUBLIC__/Adm/js/common.js"></script>
<script type="text/javascript" src="__PUBLIC__/Adm/layui/layui.js"></script>
<link href="__PUBLIC__/Adm/layui/css/layui.css" rel="stylesheet">
<link href="__PUBLIC__/Adm/css/page.css" rel="stylesheet">
<script type="text/javascript">
	$(function() {
		$("#file").on("change",function(){
			//截取路径，获取上传文件名
			 $('#submit').trigger("click");
		}); 
		
		$("#view_sn").click(function() {
			var sn=$('.sns').html();
			
		 
			var winDialog = top
			.dialog(
					{
						title : 'SN编号',
						content : sn,
						okValue : '确定' ,
						cancelValue : '取消',
						cancel : function() {
						}
					}).showModal();
		});
		$("#btnConfirm").click(function() {
			OrderConfirm();
		}); //确认订单
		$("#btnPayment").click(function() {
			OrderPayment();
		}); //确认付款
		$("#btnExpress").click(function() {
			OrderExpress();
		}); //确认发货
		$("#btnComplete").click(function() {
			OrderComplete();
		}); //完成订单
		$("#btnCancel").click(function() {
			OrderCancel();
		}); //取消订单
		$("#btnInvalid").click(function() {
			OrderInvalid();
		}); //作废订单
		$("#btnPrint").click(function() {
			OrderPrint();
		}); //打印订单
		$("#btnEditExpress").click(function() {
			EditOrderExpress(this);
		});
		$("#btnEditExpressNo").click(function() {
			EditOrderExpressNo();
		});
		$("#btnEditBack").click(function() {
			EditAcceptInfo();
		}); //修改收货信息
		
		
		$("#btnEditSN").click(function() {
			EditOrderSN();
		}); 
		$("#btnEditRemark").click(function() {
			EditOrderRemark();
		}); //修改订单备注
		$("#btnEditRealAmount").click(function() {
			EditRealAmount();
		}); //修改商品总金额
		$("#btnEditExpressFee").click(function() {
			EditExpressFee();
		}); //修改配送费用
		$("#btnEditPaymentFee").click(function() {
			EditPaymentFee();
		}); //修改支付手续费
		$("#btnEditInvoiceTaxes").click(function() {
			EditInvoiceTaxes();
		});
		$("#btnEditExpire").click(function() {
			EditExpire();
		}); //修改发票税金
	});
	//确认订单
	function OrderConfirm() {
		var winDialog = top
				.dialog(
						{
							title : '提示',
							content : '确认订单后将无法修改金额，确认要继续吗？',
							okValue : '确定',
							ok : function() {
								var postData = {
									"order_no" : $("#spanOrderNo").text(),
									"edit_type" : "order_confirm"
								};
								//发送AJAX请求
								sendAjaxUrl(winDialog, postData,
										"../../tools/admin_ajax.ashx?action=edit_order_status");
								return false;
							},
							cancelValue : '取消',
							cancel : function() {
							}
						}).showModal();
	}
	//确认付款
	function OrderPayment() {
		var winDialog = top
				.dialog(
						{
							title : '提示',
							content : '操作提示信息：<br />1、该订单使用在线支付方式，付款成功后自动确认；<br />2、如客户确实已打款而没有自动确认可使用该功能；<br />3、确认付款后无法修改金额，确认要继续吗？',
							okValue : '确定',
							ok : function() {
								var postData = {
									"order_no" : $("#spanOrderNo").text(),
									"edit_type" : "order_payment"
								};
								//发送AJAX请求
								sendAjaxUrl(winDialog, postData,
										"../../tools/admin_ajax.ashx?action=edit_order_status");
								return false;
							},
							cancelValue : '取消',
							cancel : function() {
							}
						}).showModal();
	}
	//确认发货
	function OrderExpress() {
		var winDialog = top
		.dialog(
				{
					title : '发货订单',
					content : '发货订单，确认要继续吗？',
					button : [
							{
								value : '确定',
								callback : function() {
									var postData = {
										"order_id" : $("#order_id")
												.val(),
										"express" :  $("#express")
										.val(),
										"express_no" :  $("#express_no")
										.val(),
										"sn" :  $("#sn")
										.val(),
										"spanExpire":$('#spanExpire').html()
									};
									//发送AJAX请求
									sendAjaxUrl(winDialog, postData,
											'{:U('Goods/order_express')}');
									return false;
								},
								autofocus : true
							}, {
								value : '取消',
								callback : function() {
								}
							} ]
				}).showModal();
	}
	//完成订单
	function OrderComplete() {
		var winDialog = top
				.dialog(
						{
							title : '完成订单',
							content : '订单完成后，订单处理完毕，确认要继续吗？',
							button : [
									{
										value : '确定',
										callback : function() {
											var postData = {
												"order_no" : $("#spanOrderNo")
														.text(),
												"edit_type" : "order_complete"
											};
											//发送AJAX请求
											sendAjaxUrl(winDialog, postData,
													"../../tools/admin_ajax.ashx?action=edit_order_status");
											return false;
										},
										autofocus : true
									}, {
										value : '取消',
										callback : function() {
										}
									} ]
						}).showModal();
	}
	//取消订单
	function OrderCancel() {
		var winDialog = top
				.dialog(
						{
							title : '取消订单',
							content : '操作提示信息：<br />1、匿名用户，请线下与客户沟通；<br />2、会员用户，自动检测退还金额或积分到账户；<br />3、请单击相应按钮继续下一步操作！',
							button : [
									{
										value : '检测退还',
										callback : function() {
											var postData = {
												"order_no" : $("#spanOrderNo")
														.text(),
												"edit_type" : "order_cancel",
												"check_revert" : 1
											};
											//发送AJAX请求
											sendAjaxUrl(winDialog, postData,
													"../../tools/admin_ajax.ashx?action=edit_order_status");
											return false;
										},
										autofocus : true
									},
									{
										value : '直接取消',
										callback : function() {
											var postData = {
												"order_no" : $("#spanOrderNo")
														.text(),
												"edit_type" : "order_cancel",
												"check_revert" : 0
											};
											//发送AJAX请求
											sendAjaxUrl(winDialog, postData,
													"../../tools/admin_ajax.ashx?action=edit_order_status");
											return false;
										}
									}, {
										value : '关闭',
										callback : function() {
										}
									} ]
						}).showModal();
	}
	//作废订单
	function OrderInvalid() {
		var winDialog = top
				.dialog(
						{
							title : '取消订单',
							content : '操作提示信息：<br />1、匿名用户，请线下与客户沟通；<br />2、会员用户，自动检测退还金额或积分到账户；<br />3、请单击相应按钮继续下一步操作！',
							button : [
									{
										value : '检测退还',
										callback : function() {
											var postData = {
												"order_no" : $("#spanOrderNo")
														.text(),
												"edit_type" : "order_invalid",
												"check_revert" : 1
											};
											//发送AJAX请求
											sendAjaxUrl(winDialog, postData,
													"../../tools/admin_ajax.ashx?action=edit_order_status");
											return false;
										},
										autofocus : true
									},
									{
										value : '直接作废',
										callback : function() {
											var postData = {
												"order_no" : $("#spanOrderNo")
														.text(),
												"edit_type" : "order_invalid",
												"check_revert" : 0
											};
											//发送AJAX请求
											sendAjaxUrl(winDialog, postData,
													"../../tools/admin_ajax.ashx?action=edit_order_status");
											return false;
										}
									}, {
										value : '关闭',
										callback : function() {
										}
									} ]
						}).showModal();
	}
	//打印订单
	function OrderPrint() {
		var winDialog = top.dialog(
				{
					title : '打印订单',
					url : 'dialog/dialog_print.aspx?order_no='
							+ $("#spanOrderNo").text(),
					width : 850
				}).showModal();
	}
	//修改收货信息
	function EditAcceptInfo() {
		var winDialog = top.dialog({
			title : '填写审核信息',
			url : '{:U('Goods/dialog_back')}',
			width : 550, 
			data : window
		//传入当前窗口
		}).showModal();
	}
	//修改订单备注
	function EditOrderSN() {
		var winDialog = top
				.dialog(
						{
							title : 'SN编号',
							content : '<textarea id="txtOrderSn" name="txtOrderSn" rows="2" cols="20" class="input">'
									+ $("#divSn").html() + '</textarea>',
							okValue : '确定',
							ok : function() {
								var remark = $("#txtOrderSn",
										parent.document).val();
								if (remark == "") {
									top.dialog({
										title : '提示',
										content : '对不起，请输入sn编号！',
										okValue : '确定',
										ok : function() {
										}
									}).showModal(winDialog);
									return false;
								}
								var postData = {
									"order_id" : $("#order_id").val(),
									"edit_type" : "edit_order_remark",
									"sn" : remark
								};
								sendAjaxUrl(winDialog, postData,
										'{:U('Goods/order_sn')}'); 
								return false;
							},
							cancelValue : '取消',
							cancel : function() {
							}
						}).showModal();
	}
	function EditOrderRemark() {
		var winDialog = top
				.dialog(
						{
							title : '订单备注',
							content : '<textarea id="txtOrderRemark" name="txtOrderRemark" rows="2" cols="20" class="input">'
									+ $("#divRemark").html() + '</textarea>',
							okValue : '确定',
							ok : function() {
								var remark = $("#txtOrderRemark",
										parent.document).val();
								if (remark == "") {
									top.dialog({
										title : '提示',
										content : '对不起，请输入订单备注内容！',
										okValue : '确定',
										ok : function() {
										}
									}).showModal(winDialog);
									return false;
								}
								var postData = {
									"order_no" : $("#spanOrderNo").text(),
									"edit_type" : "edit_order_remark",
									"remark" : remark
								};
								//发送AJAX请求
								sendAjaxUrl(winDialog, postData,
										"../../tools/admin_ajax.ashx?action=edit_order_status");
								return false;
							},
							cancelValue : '取消',
							cancel : function() {
							}
						}).showModal();
	}
	function EditOrderExpress(obj) {
		  
		var winDialog = top.dialog({
			title : '填写快递信息',
			url : '{:U('Goods/dialog_express')}',
			width : 550, 
			data : obj
		//传入当前窗口
		}).showModal();
		
		 
		 
	}
	function EditOrderExpressNo() {
		var winDialog = top
				.dialog(
						{
							title : '快递编号',
							content : '<textarea id="txtOrderRemark" name="txtOrderRemark" rows="2" cols="20" class="input">'
									+ $("#divExpressNo").html() + '</textarea>',
							okValue : '确定',
							ok : function() {
								var remark = $("#txtOrderRemark",
										parent.document).val();
								if (remark == "") {
									top.dialog({
										title : '提示',
										content : '对不起，请输入快递编号！',
										okValue : '确定',
										ok : function() {
										}
									}).showModal(winDialog);
									return false;
								}
								 
								 //发送AJAX请求
								$("#divExpressNo").html(remark) 
								$("#express_no").val(remark) 
								return true;
							},
							cancelValue : '取消',
							cancel : function() {
							}
						}).showModal();
	}
	//修改商品总金额
	function EditRealAmount() {
		var winDialog = top
				.dialog(
						{
							title : '请修改商品总金额',
							content : '<input id="txtDialogAmount" type="text" value="'
									+ $("#spanRealAmountValue").text()
									+ '" class="input" />',
							okValue : '确定',
							ok : function() {
								var amount = $("#txtDialogAmount",
										parent.document).val();
								if (!checkIsMoney(amount)) {
									top.dialog({
										title : '提示',
										content : '对不起，请输入正确的商品金额！',
										okValue : '确定',
										ok : function() {
										}
									}).showModal(winDialog);
									return false;
								}
								var postData = {
									"order_no" : $("#spanOrderNo").text(),
									"edit_type" : "edit_real_amount",
									"real_amount" : amount
								};
								//发送AJAX请求
								sendAjaxUrl(winDialog, postData,
										"../../tools/admin_ajax.ashx?action=edit_order_status");
								return false;
							},
							cancelValue : '取消',
							cancel : function() {
							}
						}).showModal();
	}
	//修改配送费用
	function EditExpressFee() {
		var winDialog = top
				.dialog(
						{
							title : '请修改配送费用',
							content : '<input id="txtDialogAmount" type="text" value="'
									+ $("#spanExpressFeeValue").text()
									+ '" class="input" />',
							okValue : '确定',
							ok : function() {
								var amount = $("#txtDialogAmount",
										parent.document).val();
								if (!checkIsMoney(amount)) {
									top.dialog({
										title : '提示',
										content : '对不起，请输入正确的配送金额！',
										okValue : '确定',
										ok : function() {
										}
									}).showModal(winDialog);
									return false;
								}
								var postData = {
									"order_no" : $("#spanOrderNo").text(),
									"edit_type" : "edit_express_fee",
									"express_fee" : amount
								};
								//发送AJAX请求
								sendAjaxUrl(winDialog, postData,
										"../../tools/admin_ajax.ashx?action=edit_order_status");
								return false;
							},
							cancelValue : '取消',
							cancel : function() {
							}
						}).showModal();
	}
	//修改手续费用
	function EditPaymentFee() {
		var winDialog = top
				.dialog(
						{
							title : '请修改支付手续费用',
							content : '<input id="txtDialogAmount" type="text" value="'
									+ $("#spanPaymentFeeValue").text()
									+ '" class="input" />',
							okValue : '确定',
							ok : function() {
								var amount = $("#txtDialogAmount",
										parent.document).val();
								if (!checkIsMoney(amount)) {
									top.dialog({
										title : '提示',
										content : '对不起，请输入正确的手续费用！',
										okValue : '确定',
										ok : function() {
										}
									}).showModal(winDialog);
									return false;
								}
								var postData = {
									"order_no" : $("#spanOrderNo").text(),
									"edit_type" : "edit_payment_fee",
									"payment_fee" : amount
								};
								//发送AJAX请求
								sendAjaxUrl(winDialog, postData,
										"../../tools/admin_ajax.ashx?action=edit_order_status");
								return false;
							},
							cancelValue : '取消',
							cancel : function() {
							}
						}).showModal();
	}
	//修改税金费用
	function EditInvoiceTaxes() {
		var winDialog = top
				.dialog(
						{
							title : '请修改发票税金费用',
							content : '<input id="txtDialogAmount" type="text" value="'
									+ $("#spanInvoiceTaxesValue").text()
									+ '" class="input" />',
							okValue : '确定',
							ok : function() {
								var amount = $("#txtDialogAmount",
										parent.document).val();
								if (!checkIsMoney(amount)) {
									top.dialog({
										title : '提示',
										content : '对不起，请输入正确的税金费用！',
										okValue : '确定',
										ok : function() {
										}
									}).showModal(winDialog);
									return false;
								}
								var postData = {
									"order_no" : $("#spanOrderNo").text(),
									"edit_type" : "edit_invoice_taxes",
									"invoice_taxes" : amount
								};
								//发送AJAX请求
								sendAjaxUrl(winDialog, postData,
										"../../tools/admin_ajax.ashx?action=edit_order_status");
								return false;
							},
							cancelValue : '取消',
							cancel : function() {
							}
						}).showModal();
	}
	function EditExpire() {
		var winDialog = top
				.dialog(
						{
							title : '请编辑到期时间',
							content : '<input id="Expire_day" type="text" value="'
									+ $("#spanExpire").html()
									+ '" class="input" />',
							okValue : '确定',
							ok : function() {
								var amount = $("#Expire_day",
										parent.document).val();
								 
								$("#spanExpire").html(amount) 
								 
							},
							cancelValue : '取消',
							cancel : function() {
							}
						}).showModal();
	}
	//=================================工具类的JS函数====================================
	//检查是否货币格式
	function checkIsMoney(val) {
		var regtxt = /^(([1-9]{1}\d*)|([0]{1}))(\.(\d){1,2})?$/;
		if (!regtxt.test(val)) {
			return false;
		}
		return true;
	}
	//发送AJAX请求
	function sendAjaxUrl(winObj, postData, sendUrl) {
		$.ajax({
			type : "post",
			url : sendUrl,
			data : postData,
			dataType : "json",
			error : function(XMLHttpRequest, textStatus, errorThrown) {
				top.dialog({
					title : '提示',
					content : '尝试发送失败，错误信息：' + errorThrown,
					okValue : '确定',
					ok : function() {
					}
				}).showModal(winObj);
			},
			success : function(data, textStatus) {
				if (data.status == 1) {
					winObj.close().remove();
					var d = dialog({
						content : data.msg
					}).show();
					setTimeout(function() {
						d.close().remove();
						location.reload(); //刷新页面
					}, 2000);
				} else {
					top.dialog({
						title : '提示',
						content : '错误提示：' + data.msg,
						okValue : '确定',
						ok : function() {
						}
					}).showModal(winObj);
				}
			}
		});
	}
</script>
</head>

<body class="mainbody">
	<!--导航栏-->

	<!--/导航栏-->

	<!--内容-->

	<div class="tab-content">
		<dl>
			<dd style="margin-left: 50px; text-align: center; display: none">
				<div class="order-flow" style="width: 560px">


					<if condition="$rs.status lt 4">


					<div class="item-box left arrive">
						<div class="line"></div>
						<div class="icon">
							<i class="iconfont icon-confirm-full"></i>
						</div>
						<div class="txt">
							<b>订单已生成</b>
							<p>{$rs.add_time_str}</p>
						</div>
					</div>
					<if condition="$rs.payment_status eq 1">


					<div class="item-box">
						<div class="line"></div>
						<div class="icon">
							<i class="iconfont icon-confirm-full"></i>
						</div>
						<div class="txt">
							<b>等待付款</b>
						</div>
					</div>
					</if> <if condition="$rs.payment_status eq 2">

					<div class="item-box arrive">
						<div class="line"></div>
						<div class="icon">
							<i class="iconfont icon-confirm-full"></i>
						</div>
						<div class="txt">
							<b>已付款</b>
							<p>{$rs.payment_time_str}</p>
						</div>
					</div>
					</if> <if condition="$rs.payment_status eq 0 "> <if
						condition="$rs.status eq 1">

					<div class="item-box">
						<div class="line"></div>
						<div class="icon">
							<i class="iconfont icon-confirm-full"></i>
						</div>
						<div class="txt">
							<b>等待确认</b>
						</div>
					</div>
					</if> </if> <if condition="$rs.payment_status eq 0 "> <if
						condition="$rs.status gt 1">
					<div class="item-box arrive">
						<div class="line"></div>
						<div class="icon">
							<i class="iconfont icon-confirm-full"></i>
						</div>
						<div class="txt">
							<b>已确认</b>
							<p>{$rs.confirm_time_str}</p>
						</div>
					</div>
					</if> </if> <if condition="$rs.express_status eq 1">

					<div class="item-box">
						<div class="line"></div>
						<div class="icon">
							<i class="iconfont icon-confirm-full"></i>
						</div>
						<div class="txt">
							<b>等待发货</b>
						</div>
					</div>
					</if> <if condition="$rs.express_status eq 2">

					<div class="item-box arrive">
						<div class="line"></div>
						<div class="icon">
							<i class="iconfont icon-confirm-full"></i>
						</div>
						<div class="txt">
							<b>已发货</b>
							<p>{$rs.express_time_str}</p>
						</div>
					</div>
					</if> <if condition="$rs.status eq 3">

					<div class="item-box arrive right">
						<div class="line"></div>
						<div class="icon">
							<i class="iconfont icon-confirm-full"></i>
						</div>
						<div class="txt">
							<b>订单完成</b>
							<p>{$rs.complete_time_str}</p>
						</div>
					</div>
					</if> <if condition="$rs.status neq  3">
					<div class="item-box right">
						<div class="line"></div>
						<div class="icon">
							<i class="iconfont icon-confirm-full"></i>
						</div>
						<div class="txt">
							<b>等待完成</b>
						</div>
					</div>
					</if> <if condition="$rs.status eq 4">

					<div
						style="text-align: center; line-height: 30px; font-size: 20px; color: Red;">该订单已取消</div>
					</if> <if condition="$rs.status eq 5">
					<div
						style="text-align: center; line-height: 30px; font-size: 20px; color: Red;">该订单已作废</div>
					</if> </if>
				</div>
			</dd>
		</dl>
		<dl>
			<dt>订单号</dt>
			<dd>
				<span id="spanOrderNo">{$rs.order_no}</span> <INPUT id="order_id"
					type="hidden" value="{$rs.id}">


			</dd>
		</dl>
		<dl>
			<dt>商品列表</dt>
			<dd>
				<div class="table-container">
					<table border="0" cellspacing="0" cellpadding="0"
						class="border-table" width="100%">
						<thead>
							<tr>
								<th style="text-align: left;">商品信息</th>
								<th width="8%">销售价</th>
								<!-- <th width="8%">众筹价格</th> -->
								<!-- <th width="8%">优惠价</th> -->
								<th width="8%">数量</th>
								<th width="12%">金额合计</th>
							</tr>
						</thead>
						<tbody>
							<foreach name="rs.order_goods" item="vo">
							<tr class="td_c">
								<td
									style="text-align: left; white-space: inherit; word-break: break-all; line-height: 20px;">
									{$vo.goods_title} <br /> {$vo.spec_text}
								</td>
								<td>{$vo.goods_price}</td>
								<!-- 	<td>{$vo.crowd_price}</td> -->
								<!-- <td>{$vo.real_price}</td> -->
								<td>{$vo.quantity}</td>
								<td>{$vo.all_real_price}</td>

							</tr>
							</foreach>
						</tbody>
					</table>
				</div>
			</dd>
		</dl>


		<dl>
			<dt>收货信息</dt>
			<dd>
				<div class="table-container">
					<table border="0" cellspacing="0" cellpadding="0"
						class="border-table" width="100%">
						<tr>
							<th width="20%">收件人</th>
							<td>
								<div class="position">
									<span id="spanAcceptName">{$rs.accept_name}</span>
								</div>
							</td>
						</tr>
						<tr>
							<th>发货地址</th>
							<td><span id="spanArea">{$rs.area}</span> <span
								id="spanAddress">{$rs.address}</span></td>
						</tr>

						<tr>
							<th>手机</th>
							<td><span id="spanMobile">{$rs.mobile}</span></td>
						</tr>

						<tr>
							<th valign="top">物流信息</th>
							<td>
								<div class="position">
									快递公司:
									<div id="divExpress">{$rs.express}</div>
									快递单号:
									<div id="divExpressNo">{$rs.express_no}</div>
									<input id="express_no" type="hidden" value="{$rs.express_no}" />
									<input id="express" type="hidden" value="{$rs.express}" /> <input
										id="btnEditExpress" type="button" class="ibtn" value="快递信息" />
									<!-- <input id="btnEditExpressNo" type="button" class="ibtn"
											value="修改快递编号" /> -->
								</div>
							</td>
						</tr>

					</table>
				</div>
			</dd>
		</dl>

		<dl>
			<dt>订单统计</dt>
			<dd>
				<div class="table-container">
					<table border="0" cellspacing="0" cellpadding="0"
						class="border-table" width="100%">
						<tr>
							<th width="20%">商品总金额</th>
							<td>
								<div class="position">
									<span id="spanRealAmountValue">{$rs.all_price}</span> 元
								</div>
							</td>
						</tr>


						<tr>
							<th>订单总金额</th>
							<td>{$rs.all_price} 元</td>
						</tr>
					</table>
				</div>
			</dd>
		</dl>
		<dl style="display:none" >
			<dt>SN查看</dt>
			<dd>
				<div class="table-container">
					<table border="0" cellspacing="0" cellpadding="0"
						class="border-table" width="100%">

						<foreach name="rs.user_terminal" item="vo">


						<tr>
							<th width="20%">{$vo.sn}</th>
							<td>
								<div class="position">
									<span id="spanRealAmountValue">{$vo.sn_type}</span>  
								</div>
							</td>
						</tr>

						</foreach>

					</table>
				</div>
			</dd>
		</dl>
		<if condition="$rs.status eq 2"> <if condition="$rs.status neq 4">
		<if condition="$rs.status neq 6"> <if
			condition="$rs.back_status eq 0"> <if
			condition="$rs.express_status eq 1">
		<dl style="display: none">
			<dt>pos分配</dt>
			<dd>
				<div class="table-container">
					<table border="0" cellspacing="0" cellpadding="0"
						class="border-table" width="100%" style="table-layout: fixed;">

						<tr>
							<th width="20%">sn编号</th>
							<td
								style="white-space: pre-line; word-wrap: break-word; word-break: break-all;">


								<input id="sn" name="sn" type="hidden" value="{$sns}" /> <span
								class="sns" style="position: absolute; top: 30;">{$sns} </span>
								<form method="post"
									action="{:U('Goods/order_edit')}?id={$rs.id}"
									enctype="multipart/form-data"
									style="position: absolute; top: 0;">


									<input style="display: none" type="submit" name="submit"
										id="submit" value="查看" class="file" /> <input
										style="float: left; top: 0px; position: absolute; display: none"
										type="button" name="submit" id="view_sn" value="查看"
										class="file" /> <a href="javascript:;" class="file"
										style="float: left; top: 0px; LEFT: 100PX; position: absolute; WIDTH: 80PX">选择excel
										<input type="file" id="file" name="filexls">


									</a>
								</form> <!-- <input id="btnEditSN"
											type="file" class="ibtn" value="上传" style="float: right" /> -->

							</td>
						</tr>
						<tr>
							<th>到期时间</th>
							<td><span id="spanExpire">{$rs.expire_day}</span><input
								id="btnEditExpire" type="button" class="ibtn" value="编辑到期时间"
								style="float: right" /></td>
						</tr>


					</table>
				</div>
			</dd>
		</dl>
		</if> </if></if></if></if>
		<if condition="$rs.back_time  gt 0">

		<dl>
			<dt>退换申请</dt>
			<dd>
				<div class="table-container">
					<table border="0" cellspacing="0" cellpadding="0"
						class="border-table" width="100%">
						<tr>
							<th width="20%">申请原因</th>
							<td>
								<div class="position">
									<span id="spanRealAmountValue">{$rs.back_reason}</span>
								</div>
							</td>
						</tr>
						<tr>
							<th>申请时间</th>
							<td>{$rs.back_time_str}</td>
						</tr>

						<if condition="$rs.back_check_time  gt 0">
						<tr>
							<th>审核时间</th>
							<td>{$rs.back_check_time_str}</td>
						</tr>
						</if>
						<if condition="$rs.back_check_status  eq 1">
						<tr>
							<th>驳回理由</th>
							<td>
								<div class="position">
									<span id="spanRealAmountValue">{$rs.back_check_reason}</span>
								</div>
							</td>
						</tr>
						</if>
						<if condition="$rs.back_check_status  eq 0">
						<tr>
							<th>通过理由</th>
							<td>
								<div class="position">
									<span id="spanRealAmountValue">{$rs.back_check_reason}</span>
								</div>
							</td>
						</tr>
						</if>
						<if condition="$rs.back_status  eq 1">
						<tr>
							<th>处理申请</th>
							<td>

								<div class="position">
									<input id="btnEditBack" type="button" class="ibtn" value="提交申请" />
								</div>
							</td>
						</tr>
						</if>
					</table>
				</div>
			</dd>
		</dl>
		</if>
	</div>
	<!--/内容-->


	<!--工具栏-->
	<div class="page-footer">
		<div class="btn-wrap">
			<if condition="$rs.status eq 2"> <if
				condition="$rs.status neq 4"> <if condition="$rs.status neq 6">
			  <eq
				name="rs.express_status" value="1"> <input id="btnExpress"
			  type="button" value="确认发货" class="btn" /> </EQ>  </if></if></if>

		</div>
	</div>
	<!--/工具栏-->

	<script type="text/javascript">
				layui.use('layer', function() {
					$('.ajax-a').on('click', function() {
						var self = $(this);
						layer.confirm(self.attr('info'), {
							shade : 0,
							icon : 3,
							title : '警告'
						}, function(index) {
							$url = self.attr('href');
							$.get($url, function(data) {
								if (data.status) {
									layer.msg(data.info, {
										time : 1000,
										end : function() {
											if (data.url) {
												location.href = data.url;
											} else {
												location.reload();
											}
										}
									});
								} else {
									layer.msg(data.info);
								}
							});
						});
						return false;
					});
					$('.ajax-b').on('click', function() {
						var self = $(this);
						layer.confirm(self.attr('info'), {
							shade : 0,
							icon : 3,
							title : '警告'
						}, function(index) {
							$url = self.attr('href');
							$.get($url, function(data) {
								if (data.status) {
									layer.msg(data.info, {
										time : 1000,
										end : function() {
											if (data.url) {
												location.href = data.url;
											} else {
												location.reload();
											}
										}
									});
								} else {
									layer.msg(data.info);
								}
							});
						});
						return false;
					});
				});
			</script>
</body>
</html> 